{% extends "base.html" %}

{% block title %}Kolam AI - Discover & Create Authentic Tamil Kolam Patterns{% endblock %}

{% block meta_description %}Experience the beauty of Tamil Kolam patterns with AI-powered recognition and generation. Upload your Kolam images for instant classification or create new authentic patterns using traditional methods.{% endblock %}

{% block og_title %}Kolam AI - Traditional Tamil Pattern Recognition & Generation{% endblock %}
{% block og_description %}Discover, classify, and create authentic Tamil Kolam patterns using advanced AI technology that respects cultural heritage.{% endblock %}

{% block extra_css %}
<style>
    .hero-pattern {
        position: absolute;
        width: 100px;
        height: 100px;
        opacity: 0.1;
        animation: float 15s ease-in-out infinite;
    }
    
    .hero-pattern:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; }
    .hero-pattern:nth-child(2) { top: 20%; right: 15%; animation-delay: 3s; }
    .hero-pattern:nth-child(3) { bottom: 30%; left: 20%; animation-delay: 6s; }
    .hero-pattern:nth-child(4) { bottom: 20%; right: 10%; animation-delay: 9s; }
    
    .feature-icon {
        font-size: 3rem;
        margin-bottom: 1.5rem;
        color: var(--primary-red);
    }
    
    .testimonial-card {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        height: 100%;
    }
    
    .number-counter {
        font-size: 3rem;
        font-weight: bold;
        color: var(--primary-red);
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section" id="hero">
    <!-- Floating Pattern Decorations -->
    <div class="hero-pattern">
        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="2"/>
            <circle cx="30" cy="30" r="5" fill="currentColor"/>
            <circle cx="70" cy="30" r="5" fill="currentColor"/>
            <circle cx="30" cy="70" r="5" fill="currentColor"/>
            <circle cx="70" cy="70" r="5" fill="currentColor"/>
        </svg>
    </div>
    <div class="hero-pattern">
        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <path d="M20,50 Q50,20 80,50 Q50,80 20,50" fill="none" stroke="currentColor" stroke-width="3"/>
            <circle cx="20" cy="50" r="3" fill="currentColor"/>
            <circle cx="80" cy="50" r="3" fill="currentColor"/>
        </svg>
    </div>
    <div class="hero-pattern">
        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <polygon points="50,10 90,90 10,90" fill="none" stroke="currentColor" stroke-width="2"/>
            <circle cx="50" cy="40" r="4" fill="currentColor"/>
        </svg>
    </div>
    <div class="hero-pattern">
        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <rect x="25" y="25" width="50" height="50" fill="none" stroke="currentColor" stroke-width="2" rx="10"/>
            <circle cx="50" cy="50" r="8" fill="currentColor"/>
        </svg>
    </div>
    
    <div class="container">
        <div class="hero-content">
            <h1 class="hero-title">
                Discover the Art of <span class="text-primary-yellow">Kolam</span>
            </h1>
            <p class="hero-subtitle">
                Experience Tamil cultural heritage through AI-powered pattern recognition and authentic Kolam generation. 
                Preserve tradition, embrace technology.
            </p>
            <div class="hero-actions mt-4">
                <a href="#upload-section" class="btn btn-primary-custom btn-lg me-3">
                    <i class="fas fa-upload me-2"></i>
                    Start Classifying
                </a>
                <a href="{{ url_for('generate_pattern') }}" class="btn btn-outline-custom btn-lg">
                    <i class="fas fa-magic me-2"></i>
                    Generate Patterns
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Quick Stats Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row text-center">
            <div class="col-md-3 col-6 mb-4">
                <div class="stats-card h-100">
                    <div class="number-counter" data-target="{{ statistics.total_classifications or 1250 }}">0</div>
                    <div class="stats-label">Patterns Classified</div>
                </div>
            </div>
            <div class="col-md-3 col-6 mb-4">
                <div class="stats-card h-100">
                    <div class="number-counter" data-target="{{ statistics.patterns_generated or 850 }}">0</div>
                    <div class="stats-label">Patterns Generated</div>
                </div>
            </div>
            <div class="col-md-3 col-6 mb-4">
                <div class="stats-card h-100">
                    <div class="number-counter" data-target="{{ (statistics.cultural_authenticity * 100 if statistics.cultural_authenticity is defined else 92)|round }}">0</div>
                    <div class="stats-label">Authenticity Score</div>
                </div>
            </div>
            <div class="col-md-3 col-6 mb-4">
                <div class="stats-card h-100">
                    <div class="number-counter" data-target="15">0</div>
                    <div class="stats-label">Pattern Types</div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Upload Section -->
<section class="py-5" id="upload-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="text-center mb-5">
                    <h2 class="display-5 fw-bold text-primary-red">Classify Your Kolam</h2>
                    <p class="lead text-muted">
                        Upload an image of your Kolam pattern and let our AI identify its type, 
                        cultural significance, and authenticity score.
                    </p>
                </div>
                
                <form action="{{ url_for('upload_file') }}" method="POST" enctype="multipart/form-data" id="upload-form">
                    <div class="upload-area" id="upload-area">
                        <i class="fas fa-cloud-upload-alt upload-icon"></i>
                        <div class="upload-text">Click to upload or drag and drop</div>
                        <div class="upload-subtext">Supports PNG, JPEG, GIF, BMP (Max 5MB)</div>
                        <input type="file" id="file-input" name="file" accept=".png,.jpg,.jpeg,.gif,.bmp" style="display: none;">
                    </div>
                </form>
                
                <!-- Image Preview Container -->
                <div id="preview-container" style="display: none;" class="mt-4"></div>
                
                <!-- Classification Button -->
                <div class="text-center mt-4">
                    <button type="button" id="classify-btn" class="btn btn-secondary btn-lg" disabled>
                        <i class="fas fa-search me-2"></i>
                        Classify Pattern
                    </button>
                </div>
                
                <!-- Results Container -->
                <div id="results-container" style="display: none;" class="mt-4"></div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold text-primary-red">Why Choose Kolam AI?</h2>
            <p class="lead text-muted">Advanced technology meets traditional wisdom</p>
        </div>
        
        <div class="row">
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="text-center h-100">
                    <i class="fas fa-brain feature-icon"></i>
                    <h4>AI-Powered Recognition</h4>
                    <p class="text-muted">
                        Advanced machine learning algorithms trained on thousands of authentic Kolam patterns 
                        for accurate classification and cultural validation.
                    </p>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="text-center h-100">
                    <i class="fas fa-palette feature-icon"></i>
                    <h4>Authentic Generation</h4>
                    <p class="text-muted">
                        Create new Kolam patterns that respect traditional rules, symmetry, and cultural 
                        significance while offering creative variations.
                    </p>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="text-center h-100">
                    <i class="fas fa-graduation-cap feature-icon"></i>
                    <h4>Cultural Education</h4>
                    <p class="text-muted">
                        Learn about the rich history, meanings, and regional variations of Kolam patterns 
                        with detailed cultural information and context.
                    </p>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="text-center h-100">
                    <i class="fas fa-mobile-alt feature-icon"></i>
                    <h4>Mobile Friendly</h4>
                    <p class="text-muted">
                        Access Kolam AI from any device with our responsive design. Take photos and 
                        classify patterns on the go.
                    </p>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="text-center h-100">
                    <i class="fas fa-download feature-icon"></i>
                    <h4>Export & Share</h4>
                    <p class="text-muted">
                        Download your classified patterns and generated designs in SVG or PNG format. 
                        Share your discoveries with the community.
                    </p>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="text-center h-100">
                    <i class="fas fa-shield-alt feature-icon"></i>
                    <h4>Privacy Focused</h4>
                    <p class="text-muted">
                        Your uploaded images are processed securely and automatically deleted after 24 hours. 
                        We respect your privacy and cultural content.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Recent Patterns Gallery -->
{% if recent_patterns %}
<section class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold text-primary-red">Recent Classifications</h2>
            <p class="lead text-muted">Explore patterns recently classified by our community</p>
        </div>
        
        <div class="pattern-grid">
            {% for pattern in recent_patterns %}
            <div class="pattern-item gallery-item" data-bs-toggle="modal" data-bs-target="#patternModal{{ loop.index }}">
                <img src="{{ url_for('static', filename='uploads/' + pattern.image) }}" 
                     alt="{{ pattern.type }}" class="pattern-image">
                <div class="pattern-info">
                    <h5 class="pattern-title">{{ pattern.type }}</h5>
                    <div class="pattern-meta">
                        <span class="text-muted">
                            <i class="fas fa-chart-line me-1"></i>
                            {{ (pattern.confidence * 100)|round }}% confidence
                        </span>
                        <span class="badge bg-success">Authentic</span>
                    </div>
                </div>
            </div>
            
            <!-- Pattern Detail Modal -->
            <div class="modal fade" id="patternModal{{ loop.index }}" tabindex="-1">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">{{ pattern.type }}</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <img src="{{ url_for('static', filename='uploads/' + pattern.image) }}" 
                                         class="img-fluid rounded" alt="{{ pattern.type }}">
                                </div>
                                <div class="col-md-6">
                                    <h6>Classification Details</h6>
                                    <p><strong>Pattern Type:</strong> {{ pattern.type }}</p>
                                    <p><strong>Confidence:</strong> {{ (pattern.confidence * 100)|round }}%</p>
                                    <p><strong>Authenticity:</strong> High</p>
                                    <p><strong>Region:</strong> Tamil Nadu</p>
                                    <p><strong>Complexity:</strong> Medium</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-4">
            <a href="#gallery" class="btn btn-outline-custom">
                <i class="fas fa-images me-2"></i>
                View Full Gallery
            </a>
        </div>
    </div>
</section>
{% endif %}

<!-- Cultural Information Section -->
<section class="py-5 bg-light" id="about-kolam">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6 mb-4 mb-lg-0">
                <h2 class="display-5 fw-bold text-primary-red">The Art of Kolam</h2>
                <p class="lead mb-4">
                    Kolam is a traditional decorative art form from Tamil Nadu, India, created using rice flour 
                    or chalk powder. These intricate geometric patterns are drawn daily at the entrance of homes 
                    as a symbol of welcome and prosperity.
                </p>
                
                <div class="cultural-panel">
                    <h5 class="cultural-title">Cultural Significance</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2">
                            <i class="fas fa-star text-warning me-2"></i>
                            <strong>Spiritual Protection:</strong> Believed to bring good fortune and ward off negative energy
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-heart text-danger me-2"></i>
                            <strong>Community Bonding:</strong> Shared tradition that connects generations of women
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-leaf text-success me-2"></i>
                            <strong>Environmental Harmony:</strong> Made from natural materials that nourish the earth
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-infinity text-primary me-2"></i>
                            <strong>Mathematical Beauty:</strong> Demonstrates complex geometric principles and symmetry
                        </li>
                    </ul>
                </div>
                
                <a href="#pattern-types" class="btn btn-primary-custom mt-3">
                    <i class="fas fa-book-open me-2"></i>
                    Learn More About Patterns
                </a>
            </div>
            
            <div class="col-lg-6">
                <div class="position-relative">
                    <img src="{{ url_for('static', filename='images/traditional-kolam.jpg') }}" 
                         alt="Traditional Kolam being drawn" class="img-fluid rounded shadow-lg">
                    <div class="position-absolute bottom-0 start-0 p-3 text-white bg-dark bg-opacity-50 rounded">
                        <small>
                            <i class="fas fa-info-circle me-1"></i>
                            Traditional Kolam being drawn at dawn
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Pattern Types Section -->
<section class="py-5" id="pattern-types">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold text-primary-red">Types of Kolam Patterns</h2>
            <p class="lead text-muted">Discover the variety and complexity of traditional designs</p>
        </div>
        
        <div class="row">
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="result-card text-center h-100">
                    <div class="mb-3">
                        <svg width="80" height="80" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="20" cy="20" r="3" fill="var(--primary-red)"/>
                            <circle cx="50" cy="20" r="3" fill="var(--primary-red)"/>
                            <circle cx="80" cy="20" r="3" fill="var(--primary-red)"/>
                            <circle cx="20" cy="50" r="3" fill="var(--primary-red)"/>
                            <circle cx="50" cy="50" r="3" fill="var(--primary-red)"/>
                            <circle cx="80" cy="50" r="3" fill="var(--primary-red)"/>
                            <circle cx="20" cy="80" r="3" fill="var(--primary-red)"/>
                            <circle cx="50" cy="80" r="3" fill="var(--primary-red)"/>
                            <circle cx="80" cy="80" r="3" fill="var(--primary-red)"/>
                            <path d="M15,15 L55,15 L85,45 L85,85 L45,85 L15,55 Z" fill="none" stroke="var(--primary-red)" stroke-width="2"/>
                        </svg>
                    </div>
                    <h4>Pulli Kolam</h4>
                    <p class="text-muted">
                        Dot-based patterns where dots are connected with curved lines to create intricate designs. 
                        The foundation of most traditional Kolam patterns.
                    </p>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="result-card text-center h-100">
                    <div class="mb-3">
                        <svg width="80" height="80" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20,50 Q30,30 50,50 Q70,30 80,50 Q70,70 50,50 Q30,70 20,50" 
                                  fill="none" stroke="var(--primary-red)" stroke-width="3"/>
                            <path d="M35,35 Q50,20 65,35 Q50,50 35,35" 
                                  fill="none" stroke="var(--primary-yellow)" stroke-width="2"/>
                            <path d="M35,65 Q50,80 65,65 Q50,50 35,65" 
                                  fill="none" stroke="var(--primary-yellow)" stroke-width="2"/>
                        </svg>
                    </div>
                    <h4>Sikku Kolam</h4>
                    <p class="text-muted">
                        Interlaced patterns drawn in a single continuous line without lifting the hand. 
                        Represents the interconnectedness of life and the universe.
                    </p>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="result-card text-center h-100">
                    <div class="mb-3">
                        <svg width="80" height="80" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <rect x="25" y="25" width="50" height="50" fill="none" stroke="var(--primary-red)" stroke-width="2"/>
                            <rect x="35" y="35" width="30" height="30" fill="none" stroke="var(--primary-yellow)" stroke-width="2"/>
                            <circle cx="50" cy="50" r="8" fill="none" stroke="var(--secondary-orange)" stroke-width="2"/>
                            <path d="M40,40 L60,60 M60,40 L40,60" stroke="var(--primary-red)" stroke-width="1"/>
                        </svg>
                    </div>
                    <h4>Kambi Kolam</h4>
                    <p class="text-muted">
                        Grid-based geometric patterns using straight lines and angles. Often features 
                        nested squares and triangular elements with perfect symmetry.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Call to Action Section -->
<section class="py-5 bg-primary text-white" style="background: linear-gradient(135deg, var(--primary-red), var(--secondary-orange));">
    <div class="container text-center">
        <h2 class="display-6 fw-bold mb-3">Ready to Explore Kolam Patterns?</h2>
        <p class="lead mb-4">
            Join thousands of users in preserving and celebrating Tamil cultural heritage through technology.
        </p>
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="d-flex flex-column flex-md-row gap-3 justify-content-center">
                    <a href="#upload-section" class="btn btn-light btn-lg">
                        <i class="fas fa-upload me-2"></i>
                        Classify Your First Pattern
                    </a>
                    <a href="{{ url_for('generate_pattern') }}" class="btn btn-outline-light btn-lg">
                        <i class="fas fa-magic me-2"></i>
                        Generate New Patterns
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
// Counter animation for statistics
function animateCounters() {
    const counters = document.querySelectorAll('.number-counter');
    const speed = 200;
    
    counters.forEach(counter => {
        const target = parseInt(counter.getAttribute('data-target'));
        const count = parseInt(counter.innerText);
        const inc = target / speed;
        
        if (count < target) {
            counter.innerText = Math.ceil(count + inc);
            setTimeout(() => animateCounters(), 1);
        } else {
            counter.innerText = target;
        }
    });
}

// Intersection Observer for counter animation
const statsSection = document.querySelector('.stats-card').closest('section');
const statsObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            animateCounters();
            statsObserver.unobserve(entry.target);
        }
    });
}, { threshold: 0.5 });

if (statsSection) {
    statsObserver.observe(statsSection);
}

// Smooth scrolling for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// Enhanced upload area interactions
const uploadArea = document.getElementById('upload-area');
const fileInput = document.getElementById('file-input');

if (uploadArea && fileInput) {
    // File selection through click
    uploadArea.addEventListener('click', () => fileInput.click());
    
    // Drag and drop functionality
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, preventDefaults, false);
    });
    
    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }
    
    ['dragenter', 'dragover'].forEach(eventName => {
        uploadArea.addEventListener(eventName, highlight, false);
    });
    
    ['dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, unhighlight, false);
    });
    
    function highlight() {
        uploadArea.classList.add('drag-over');
    }
    
    function unhighlight() {
        uploadArea.classList.remove('drag-over');
    }
    
    uploadArea.addEventListener('drop', handleDrop, false);
    
    function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        if (files.length > 0) {
            fileInput.files = files;
            // Trigger file processing
            if (window.processFile) {
                window.processFile(files[0]);
            }
        }
    }
}

// Pattern gallery modal enhancements
document.querySelectorAll('.gallery-item').forEach(item => {
    item.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-8px) scale(1.02)';
    });
    
    item.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0) scale(1)';
    });
});
</script>
{% endblock %}